<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Reading Practice Pro - Full Test</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Playfair+Display:wght@700;900&display=swap');
        
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; margin: 0; overflow: hidden; }
        .font-serif { font-family: 'Playfair Display', serif; }
        .user-highlight { border-radius: 4px; padding: 1px 0; background-color: rgba(254, 240, 138, 0.8); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; border: 2px solid white; }
        ::-webkit-scrollbar-thumb:hover { background: #cbd5e1; }
        .passage-container p { margin-bottom: 2.5rem; line-height: 1.9; color: #475569; text-align: justify; }
        
        input.flexible-input {
            min-width: 40px;
            transition: width 0.1s ease;
        }

        .review-highlight {
            background-color: #fef08a !important;
            box-shadow: 0 0 0 4px rgba(254, 240, 138, 0.4);
            border-radius: 4px;
            color: #1e293b !important;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, memo, useMemo } = React;

        /**
         * STATIC CONTENT MODULE
         */
        const IELTS_CONTENT_DATABASE = [
          {
            id: 1,
            title: "How tennis rackets have changed",
            content: `
              <p><span id="s1">In 2016, the British professional tennis player Andy Murray was ranked as the world’s number one.</span> <span id="s2">It was an incredible achievement by any standard – made even more remarkable by the fact that he did this during a period considered to be one of the strongest in the sport’s history, competing against the likes of Rafael Nadal, Roger Federer and Novak Djokovic, to name just a few.</span> <span id="s3">Yet five years previously, he had been regarded as a talented outsider who entered but never won the major tournaments.</span></p>
              <p><span id="s4">Of the changes that account for this transformation, one was visible and widely publicised: in 2011, Murray invited former number one player Ivan Lendl onto his coaching team – a valuable addition that had a visible impact on the player’s playing style.</span> <span id="s5">Another change was so subtle as to pass more or less unnoticed.</span> <span id="s6">Like many players, Murray has long preferred a racket that consists of two types of string: one for the mains (verticals) and another for the crosses (horizontals).</span> <span id="s7">While he continued to use natural string in the crosses, in 2012 he switched to a synthetic string for the mains.</span> <span id="s8">A small change, perhaps, but its importance should not be underestimated.</span></p>
              <p><span id="s9">The modification that Murray made is just one of a number of options available to players looking to tweak their rackets in order to improve their games.</span> <span id="s10">‘Touring professionals have their rackets customised to their specific needs,’ says Colin Triplow, a UK-based professional racket stringer.</span> <span id="s11">‘It’s a highly important part of performance maximisation.’</span> <span id="s12">Consequently, the specific rackets used by the world’s elite are not actually readily available to the public; rather, each racket is individually made to suit the player who uses it.</span> <span id="s13">Take the US professional tennis players Mike and Bob Bryan, for example: ‘We’re very particular with our racket specifications,’ they say.</span> <span id="s14">‘All our rackets are sent from our manufacturer to Tampa, Florida, where our frames go through a … thorough customisation process.’</span> <span id="s15">They explain how they have adjusted not only racket length, but even experimented with different kinds of paint.</span> <span id="s16">The rackets they use now weigh more than the average model and also have a denser string pattern (i.e. more crosses and mains).</span></p>
              <p><span id="s17">The primary reason for these modifications is simple: as the line between winning and losing becomes thinner and thinner, even these slight changes become more and more important.</span> <span id="s18">As a result, players and their teams are becoming increasingly creative with the modifications to their rackets as they look to maximise their competitive advantage.</span></p>
              <p><span id="s19">Racket modifications mainly date back to the 1970s, when the amateur German tennis player Werner Fischer started playing with the so-called spaghetti-strung racket.</span> <span id="s20">It created a string bed that generated so much topspin that it was quickly banned by the International Tennis Federation.</span> <span id="s21">Interests, within a decade or two, racket modification became a regularity.</span> <span id="s22">Today it is, in many ways, an aspect of the game that is equal in significance to nutrition or training.</span></p>
              <p><span id="s23">Modifications can be divided into two categories: those to the string bed and those to the racket frame.</span> <span id="s24">The former is far more common than the latter: the choice of the strings and the tension with which they are installed is something that nearly all professional players experiment with.</span> <span id="s25">They will continually change it depending on various factors including the court surface, climatic conditions, and game styles.</span> <span id="s26">Some will even change it depending on how they feel at the time.</span></p>
              <p><span id="s27">At one time, all tennis rackets were strung with natural gut made from the outer layer of sheep or cow intestines.</span> <span id="s28">This all changed in the early 1990s with the development of synthetic strings that were cheaper and more durable.</span> <span id="s29">They are made from three materials: nylon (relatively durable and affordable), Kevlar (too stiff to be used alone) or co-polyester (polyester combined with additives that enhance its performance).</span> <span id="s30">Even so, many professional players continue to use a ‘hybrid set-up’, where a combination of both synthetic and natural strings are used.</span></p>
              <p><span id="s31">Of the synthetics, co-polyester is by far the most widely used.</span> <span id="s32">It’s a perfect fit for the style of tennis now played, where players tend to battle it out from the back of the court rather than coming to the net.</span> <span id="s33">Studies indicate that the average spin from a co-polyester string is 25% greater than that from natural string or other synthetics.</span> <span id="s34">In a sense, the development of co-polyester strings has revolutionised the game.</span></p>
              <p><span id="s35">However, many players go beyond these basic adjustments to the strings and make changes to the racket frame itself.</span> <span id="s36">For example, much of the serving power of US professional player Pete Sampras was attributed to the addition of four to five lead weights onto his rackets, and today many professionals have the weight adjusted during the manufacturing process.</span></p>
              <p><span id="s37">Other changes to the frame involve the handle.</span> <span id="s38">Players have individual preferences for the shape of the handle and some will have the handle of one racket moulded onto the frame of a different racket.</span> <span id="s39">Other players make different changes.</span> <span id="s40">Portugal Portuguese player Gonçalo Oliveira replaced the original grips of his rackets with something thinner because they had previously felt uncomfortable to hold.</span></p>
              <p><span id="s41">Racket customisation and modification have pushed the standards of the game to greater levels that few could have anticipated in the days of natural strings and heavy, wooden frames, and it’s exciting to see what further developments there will be in the future.</span></p>
            `,
            groups: [
              {
                instruction: "Do the following statements agree with the information given in Reading Passage 1?\nTRUE / FALSE / NOT GIVEN",
                questions: [
                  { id: "q1", type: "choice", text: "1. People had expected Andy Murray to become the world's top tennis player for at least five years before 2016.", options: ["TRUE", "FALSE", "NOT GIVEN"], correct: "FALSE", sourceId: "s3", explanation: "Andy Murray was regarded as a 'talented outsider' five years previously, not as a future world number one." },
                  { id: "q2", type: "choice", text: "2. The change that Andy Murray made to his rackets attracted a lot of attention.", options: ["TRUE", "FALSE", "NOT GIVEN"], correct: "FALSE", sourceId: "s5", explanation: "The text states the change was 'so subtle as to pass more or less unnoticed'." },
                  { id: "q3", type: "choice", text: "3. Most of the world's top players take a professional racket stringer on tour with them.", options: ["TRUE", "FALSE", "NOT GIVEN"], correct: "NOT GIVEN", sourceId: "s10", explanation: "The text mentions professional stringers exist, but not whether players take them on tour." },
                  { id: "q4", type: "choice", text: "4. Mike and Bob Bryan use rackets that are light in comparison to the majority of rackets.", options: ["TRUE", "FALSE", "NOT GIVEN"], correct: "FALSE", sourceId: "s16", explanation: "Their rackets 'weigh more than the average model', meaning they are heavier, not lighter." },
                  { id: "q5", type: "choice", text: "5. Werner Fischer played with a spaghetti-strung racket that he designed himself.", options: ["TRUE", "FALSE", "NOT GIVEN"], correct: "NOT GIVEN", sourceId: "s19", explanation: "The text confirms he used the racket, but doesn't mention who designed it." },
                  { id: "q6", type: "choice", text: "6. The weather can affect how professional players adjust the strings on their rackets.", options: ["TRUE", "FALSE", "NOT GIVEN"], correct: "TRUE", sourceId: "s25", explanation: "Players change strings depending on factors including 'climatic conditions'." },
                  { id: "q7", type: "choice", text: "7. It was believed that the change Pete Sampras made to his rackets contributed to his strong serve.", options: ["TRUE", "FALSE", "NOT GIVEN"], correct: "TRUE", sourceId: "s36", explanation: "His serving power was attributed to the addition of lead weights to his rackets." }
                ]
              },
              {
                instruction: "Complete the notes below. Choose ONE WORD ONLY from the passage for each answer.",
                questions: [
                  { id: "q8", type: "gap", text: "8. Mike and Bob Bryan made changes to the types of ______ used on their racket frames.", correct: "paint", sourceId: "s15", explanation: "They experimented with 'different kinds of paint'." },
                  { id: "q9", type: "gap", text: "9. Players were not allowed to use the spaghetti-strung racket because of the amount of ______ it created.", correct: "topspin", sourceId: "s20", explanation: "It generated so much 'topspin' that it was banned." },
                  { id: "q10", type: "gap", text: "10. Changes to rackets can be regarded as being as important as players’ diets or the ______ they do.", correct: "training", sourceId: "s22", explanation: "Modification is equal in significance to 'nutrition or training'." },
                  { id: "q11", type: "gap", text: "11. All rackets used to have natural strings made from the ______ of animals.", correct: "intestines/gut", sourceId: "s27", explanation: "Strings were made from sheep or cow 'intestines' or 'gut'." },
                  { id: "q12", type: "gap", text: "12. Pete Sampras had metal ______ put into the frames of his rackets.", correct: "weights", sourceId: "s36", explanation: "He added four to five lead 'weights' onto his rackets." },
                  { id: "q13", type: "gap", text: "13. Gongalo Oliveira changed the ______ on his racket handles.", correct: "grips", sourceId: "s40", explanation: "He replaced the original 'grips' of his rackets." }
                ]
              }
            ]
          },
          {
            id: 2,
            title: "Should we try to bring extinct species back to life?",
            content: `
              <p><strong>A.</strong> <span id="s42">The passenger pigeon was a legendary species.</span> <span id="s43">Flying in vast numbers across North America, with potentially many millions within a single flock, their migration was once one of nature’s great spectacles.</span> <span id="s44">Sadly, the passenger pigeon’s existence came to an end on 1 September 1914, when the last living specimen died at Cincinnati Zoo.</span> <span id="s45">Geneticist Ben Novak is lead researcher on an ambitious project which now aims to bring the bird back to life through a process known as ‘de-extinction’.</span> <span id="s46">The basic premise involves using cloning technology to turn the DNA of extinct animals into a fertilised embryo, which is carried by the nearest relative still in existence — in this case, the abundant band-tailed pigeon — before being born as a living, breathing animal.</span> <span id="s47">Passenger pigeons are one of the pioneering species in this field, but they are far from the only ones on which this cutting-edge technology is being trialled.</span></p>
              <p><strong>B.</strong> <span id="s48">In Australia, the thylacine, more commonly known as the Tasmanian tiger, is another extinct creature which genetic scientists are striving to bring back to life.</span> <span id="s49">‘There is no carnivore now in Tasmania that fills the niche which thylacines once occupied,’ explains Michael Archer of the University of New South Wales.</span> <span id="s50">He points out that in the decades since the thylacine went extinct, there has been a spread in a ‘dangerously debilitating’ facial tumour syndrome which threatens the existence of the Tasmanian devils, the island’s other notorious resident.</span> <span id="s51">Thylacines would have prevented this spread because they would have killed significant numbers of Tasmanian devils.</span> <span id="s52">‘If that contagious cancer had popped up previously, it would have burned out in whatever region it started.’</span> <span id="s53">The return of thylacines to Tasmania could help to ensure that devils are never again subjected to risks of this kind.</span></p>
              <p><strong>C.</strong> <span id="s54">If extinct species can be brought back to life, can humanity begin to correct the damage it has caused to the natural world over the past few millennia?</span> <span id="s55">‘The idea of de-extinction is that we can reverse this process, bringing species that no longer exist back to life,’ says Beth Shapiro of University of California Santa Cruz's Genomics Institute.</span> <span id="s56">‘I don’t think that we can do this.</span> <span id="s57">There is no way to bring back something that is 100 per cent identical to a species that went extinct a long time ago.’</span> <span id="s58">A more practical approach for long-extinct species is to take the DNA of existing species as a template, ready for the insertion of strands of extinct animal DNA to create something new; a hybrid, based on the living species, but which looks and//acts like the animal which died out.</span></p>
              <p><strong>D.</strong> <span id="s59">This complicated process and questionable outcome begs the question: what is the actual point of this technology?</span> <span id="s60">‘For us, the goal has always been replacing the extinct species with a suitable replacement,’ explains Novak.</span> <span id="s61">‘When it comes to breeding, band-tailed pigeons scatter and make maybe one or two nesis per hectare, whereas passenger pigeons were very social and would make 10,000 or more nests in one hectare.’</span> <span id="s61a">Since the disappearance of this key species, ecosystems in the eastern US have suffered, as the lack of disturbance caused by thousands of passenger pigeons wrecking trees and branches means there has been minimal need for regrowth.</span> <span id="s62">This has left forests stagnant and vì vậy unwelcoming to the plants and animals which evolved to help regenerate the forest after a disturbance.</span> <span id="s63">According to Novak, a hybridised band-tailed pigeon, with the added nesting habits of a passenger pigeon, could, in theory, re-establish that forest disturbance, thereby creating a habitat necessary for a great many other native species to thrive.</span></p>
              <p><strong>E.</strong> <span id="s65">Another popular candidate for this technology is the woolly mammoth.</span> <span id="s66">George Church, professor at Harvard Medical School and leader of the Woolly Mammoth Revival Project, has been focusing on cold resistance, the main way in which the extinct woolly mammoth and its nearest living relative, the Asian elephant, differ.</span> <span id="s67">By pinpointing which genetic traits made it possible for mammoths to survive the icy climate of the tundra, the project's goal is to return mammoths, or a mammoth-like species, to the area.</span> <span id="s68">‘My highest priority would be preserving the endangered Asian elephant,’ says Church, ‘expanding their range to the huge ecosystem of the tundra.</span> <span id="s69">Necessary adaptations would include smaller ears, thicker hair, and extra insulating fat, all for the purpose of reducing heat loss in the tundra, and all traits found in the now extinct woolly mammoth.’</span> <span id="s70">This repopulation of the tundra and boreal forests of Eurasia and North America with large mammals could also be a useful factor in reducing carbon emissions — elephants punch holes through snow and knock down trees, which encourages grass growth.</span> <span id="s71">This grass growth would reduce temperatures, and mitigate emissions from melting permafrost.</span></p>
              <p><strong>F.</strong> <span id="s72">While the prospect of bringing extinct animals back to life might capture imaginations, it is, of course, far easier to try to save an existing species which is merely threatened with extinction.</span> <span id="s73">‘Many of the technologies that people have in mind when they think about de-extinction can be used as a form of “genetic rescue”,’ explains Shapiro.</span> <span id="s74">She prefers to focus the debate on how this emerging technology could be used to fully understand why various species went extinct in the first place, and therefore how we could use it to make genetic modifications which could prevent mass extinctions in the future.</span> <span id="s75">‘I would also say there’s an incredible moral hazard to not do anything at all,’ she continues.</span> <span id="s76">‘We know that what we are doing today is not enough, and we have to be willing to take some calculated and measured risks.’</span></p>
            `,
            groups: [
              {
                instruction: "Which paragraph contains the following information?\nWrite the correct letter, A-F.",
                questions: [
                  { id: "q14", type: "gap", text: "14. a reference to how further disappearance of multiple species could be avoided: ______", correct: "F", sourceId: "s74", explanation: "Paragraph F discusses using technology to 'prevent mass extinctions in the future'." },
                  { id: "q15", type: "gap", text: "15. explanation of a way of reproducing an extinct animal using the DNA of only that species: ______", correct: "A", sourceId: "s46", explanation: "Paragraph A explains the 'cloning technology to turn the DNA of extinct animals into a fertilised embryo'." },
                  { id: "q16", type: "gap", text: "16. reference to a habitat which has suffered following the extinction of a species: ______", correct: "D", sourceId: "s62", explanation: "Paragraph D describes how 'ecosystems in the eastern US have suffered' since the disappearance of the pigeon." },
                  { id: "q17", type: "gap", text: "17. mention of the exact point at which a particular species became extinct: ______", correct: "A", sourceId: "s44", explanation: "Paragraph A gives the exact date: '1 September 1914'." }
                ]
              },
              {
                instruction: "Complete the summary below. Choose NO MORE THAN TWO WORDS from the passage for each answer.",
                questions: [
                  { 
                    id: "summary-p2", 
                    type: "paragraph-gap", 
                    text: "The woolly mammoth revival project\n\nProfessor George Church and his team are trying to identify the (18) [q18] which enabled mammoths to live in the tundra. The findings could help preserve the mammoth's close relative, the endangered Asian elephant. According to Church, introducing Asian elephants to the tundra would involve certain physical adaptations to minimize (19) [q19]. To survive in the tundra, the species would need to have the mammoth-like features of thicker hair, (20) [q20] of a reduced size and more (21) [q21]. Repopulating the tundra with mammoths or Asian elephant/mammoth hybrids would also have an impact on the environment, which could help to reduce temperatures and decrease (22) [q22].",
                    gaps: {
                      "q18": { correct: "genetic traits", sourceId: "s67", explanation: "Church identifies 'genetic traits' that allowed mammoths to survive." },
                      "q19": { correct: "heat loss", sourceId: "s69", explanation: "Adaptations are for 'the purpose of reducing heat loss'." },
                      "q20": { correct: "ears", sourceId: "s69", explanation: "Adaptations include 'smaller ears'." },
                      "q21": { correct: "insulating fat", sourceId: "s69", explanation: "Adaptations include 'extra insulating fat'." },
                      "q22": { correct: "emissions", sourceId: "s71", explanation: "Grass growth would 'mitigate emissions from melting permafrost'." }
                    }
                  }
                ]
              },
              {
                instruction: "Question 23 - 26\nLook at the following statements and the list of people below.\nMatch each statement with the correct person, A, B or C.\nWrite the correct letter, A, B or C, in boxes on your answer sheet.\nNB You may use any letter more than once.\n\nList of Findings\nA. Ben Novak\nB. Michael Archer\nC. Beth Shapiro",
                questions: [
                  { id: "q23", type: "gap", text: "23. Reintroducing an extinct species to its original habitat could improve the health of a particular species living there: ______", correct: "b", sourceId: "s53", explanation: "Michael Archer states that the return of thylacines could protect Tasmanian devils from contagious cancer." },
                  { id: "q24", type: "gap", text: "24. It is important to concentrate on the causes of an animal's extinction: ______", correct: "c", sourceId: "s74", explanation: "Beth Shapiro prefers to focus on 'why various species went extinct in the first place'." },
                  { id: "q25", type: "gap", text: "25. A species brought back from extinction could have an important beneficial impact on the vegetation of its habitat: ______", correct: "a", sourceId: "s63", explanation: "Ben Novak claims hybridization could re-establish forest disturbance necessary for native species." },
                  { id: "q26", type: "gap", text: "26. Our current efforts at preserving biodiversity are insufficient: ______", correct: "c", sourceId: "s75", explanation: "Beth Shapiro says 'what we are doing today is not enough'." }
                ]
              }
            ]
          },
          {
            id: 3,
            title: "Marketing And Mind Control",
            content: `
              <p><span id="s78">While there had been a long tradition of giving rings as a commitment to marry, the custom of giving diamond engagement rings was in large part manufactured by one of the most effective marketing campaigns in history.</span> <span id="s79">In the early 1900s, diamond sales were declining, posing a serious problem for the company that essentially had control over the diamond market.</span> <span id="s80">In 1938, this company hired an advertising agency which proposed reshaping social attitudes toward diamonds.</span> <span id="s81">As well as magazines showing film stars draped in diamonds, the agency arranged for movies to incorporate diamond engagement rings into their plots.</span> <span id="s82">The campaign culminated with the slogan: 'A diamond is forever.'</span> <span id="s83">At the time, the approach was unique.</span> <span id="s84">Rather than pushing a brand, the objective was to promote diamonds as the symbol of everlasting love.</span> <span id="s85">This was achieved by exploiting the associative nature of the brain: associating neurons activated by the concept of 'love' with neurons that encoded the concept of 'diamonds'.</span> <span id="s86">By 1941, diamond sales had increased by 55%.</span></p>
              <p><span id="s87">Advertising comes in many forms, from blatant neon signs to subtly embedded products in movies.</span> <span id="s88">In each case, the goal is to mould our habits, desires and opinions.</span> <span id="s89">Our visual system is targeted by an avalanche of information on the internet, street posters, and billboards and in movie theatres.</span> <span id="s90">Our auditory system submits to catchy radio jingles and telemarketers.</span> <span id="s91">More surreptitiously, our olfactory system is targeted by variations of vanilla and citrus perfumes aimed at enticing us to linger in a retail outlet.</span> <span id="s92">It is difficult to measure how effective these campaigns are, but they can be so successful that they change the fabric of our culture.</span> <span id="s93">In the case of bottled water, we are swayed by advertising into paying for something that we can obtain for free.</span> <span id="s94">Most people cannot distinguish bottled from tap water, much less between brands of bottled water, which is why you rarely hear of a bottled water company proposing a blind taste test.</span></p>
              <p><span id="s95">So why is marketing such an effective mind-control technique?</span> <span id="s96">It is interesting to consider whether other animals exhibit anything analogous to humans' susceptibility to advertising.</span> <span id="s97">If we provide a lab rat with two types of cereal, it will consume approximately the same amount of each.</span> <span id="s98">However, if we put that rat with another rat that spent its day eating just one type, our rat will now show a preference for the same type as the other rat was eating.</span> <span id="s99">Psychologists call this 'socially transmitted food preference'.</span></p>
              <p><span id="s100">What many regard as the first documented examples of cultural learning in primates started with a clever monkey that lived in a colony of Japanese monkeys on the island of Koshima.</span> <span id="s101">She began taking her dirt-covered sweet potatoes to the river to wash them before eating them.</span> <span id="s102">Upon seeing this, a few 11 other open-minded monkeys picked up on the idea.</span> <span id="s103">Potato washing then spread from monkey to monkey and, over the course of a few years, most monkeys were eating clean potatoes.</span> <span id="s104">Humans are clearly not the only animals to engage in imitation and social learning.</span></p>
              <p><span id="s105">Learning by observation can be an extraordinarily valuable brain feature.</span> <span id="s106">This is how we learn to communicate and perform motor skills as well as deal with many everyday problems.</span> <span id="s107">For example, a newcomer struggling to purchase tickets and navigate the subway system in a foreign city may step back to learn from the people nearby.</span> <span id="s108">Humans and other primates exhibit multiple forms of imitative learning, and this is called cultural transmission.</span></p>
              <p><span id="s109">A component of advertising relies on the marketer's ability to tap into the brain’s propensity for imitation.</span> <span id="s110">Anybody who has watched TV knows advertisements are disproportionately populated with attractive, successful looking individuals.</span> <span id="s111">If we are going to imitate someone, we are more inclined to imitate those who appear to be popular and appealing.</span></p>
              <p><span id="s112">Although not all researchers are convinced by the findings, a number of studies indicate that some animals also imitate dominant members of their group.</span> <span id="s113">Primatologist Frans de Waal provides anecdotal evidence of preferential imitation among chimpanzees.</span> <span id="s114">He noted that in one particular group the dominant male was hurt and was limping as a result.</span> <span id="s115">Soon other chimpanzees were also limping.</span></p>
              <p><span id="s116">Imitation is undoubtedly an invaluable ability, but often our propensity to imitate generalises indiscriminately, leading to poor decisions.</span> <span id="s117">When athlete Dick Fosbury revolutionised the high jump by jumping over the bar backward in 1968, imitators obviously copied his jumping style, not his brand of sports shoes.</span> <span id="s118">However, today, sports people appear in advertisements asking us to buy the laptops or sports drinks that they promote.</span> <span id="s119">Rationally, we know these people's success did not depend on these products, so it seems our propensity to purchase products relates more to neural programs that evolved to encourage imitation of those further up the social ladder.</span> <span id="s120">Today, companies engage in stealth marketing campaigns in which people are paid to frequent bars or websites to covertly promote certain products.</span> <span id="s121">Companies also perform studies in which they track the eye movements of people viewing displays, and carefully craft names, packages and jingles associated with their products.</span> <span id="s122">While we may like to believe that manipulation on a grand scale would not be possible, that's not to say that advertising is innately harmful.</span> <span id="s123">To the contrary, the marketing of products or ideas is essential to human culture.</span></p>
            `,
            groups: [
              {
                instruction: "Questions 27-31\nChoose the correct letter, A, B, c or D.\nWrite the correct letter in boxes 1-5 on your answer sheet.",
                questions: [
                  { id: "q27", type: "choice", text: "27. According to the writer, which marketing technique attempts to make consumers stay in a shop for longer?", options: ["A. playing appealing music", "B. emitting pleasant scents", "C. displaying attractive posters", "D. making in - store announcements"], correct: "B. emitting pleasant scents", sourceId: "s91", explanation: "Targeting the olfactory system with variations of vanilla and citrus perfumes aimed at enticing us to linger (stay longer) in a retail outlet." },
                  { id: "q28", type: "choice", text: "28. The writer mentions bottled water in order to show that", options: ["A. consumers buy it because of the fact that it is marketed.", "B. people purchase it despite the fact that it has no taste.", "C. marketers need not do taste tests when a campaign is effective.", "D. tests prove that people cannot differentiate it from tap water."], correct: "A. consumers buy it because of the fact that it is marketed.", sourceId: "s93", explanation: "In the case of bottled water, we are swayed by advertising into paying for something that we can obtain for free." },
                  { id: "q29", type: "choice", text: "29. According to the writer, socially transmitted food preference occurs when", options: ["A. only dominant members of an animal group influence what others eat.", "B. the same types of animals naturally prefer the same types of food.", "C. animals are influenced by what any other animals of the same species eat.", "D. a food type is more desirable because an animal views that food as scarce."], correct: "C. animals are influenced by what any other animals of the same species eat.", sourceId: "s98", explanation: "The rat shows a preference for the same type as the other rat was eating (influenced by others of the same species)." },
                  { id: "q30", type: "choice", text: "30. According to the writer, how is learning by observation and imitation a useful feature of the brain?", options: ["A. it helps people overcome challenges.", "B. positive models can influence social behaviour.", "C. it can give an advantage when communicating with others.", "D. cultural norms and relationships can be understood more easily"], correct: "A. it helps people overcome challenges.", sourceId: "s106", explanation: "This is how we learn to communicate and perform motor skills as well as deal with many everyday problems (overcome challenges)." },
                  { id: "q31", type: "choice", text: "31. According to the writer, how does television advertising exploit the human tendency to imitate others?", options: ["A. It shows buying behaviour that marketers want to encourage in viewers.", "B. It features people who have a desirable image.", "C. It shows older people whom teenagers admire.", "D. It features successful people endorsing products responsible for their success."], correct: "B. It features people who have a desirable image.", sourceId: "s110", explanation: "Advertisements are disproportionately populated with attractive, successful looking individuals (people who have a desirable image)." }
                ]
              },
              {
                instruction: "Questions 32-36\nDo the following statements agree with the claims of the writer in Reading Passage?\nIn boxes 32-36 on your answer sheet, write\nYES if the statement agrees with the claims of the writer\nNO if the statement contradicts the claims of the writer\nNOT GIVEN if it is impossible to say what the writer thinks about this",
                questions: [
                  { id: "q32", type: "choice", text: "32. The diamond campaign worked by making a connection in people's minds between diamonds and luxury", options: ["YES", "NO", "NOT GIVEN"], correct: "NO", sourceId: "s84", explanation: "The objective was to promote diamonds as the symbol of everlasting love, not luxury." },
                  { id: "q33", type: "choice", text: "33. People are more aware of visual marketing than auditory marketing.", options: ["YES", "NO", "NOT GIVEN"], correct: "NOT GIVEN", explanation: "The text mentions both visual and auditory systems are targeted, but does not compare which one people are more aware of." },
                  { id: "q34", type: "choice", text: "34. The campaign advertising diamonds had a positive influence on society.", options: ["YES", "NO", "NOT GIVEN"], correct: "NOT GIVEN", explanation: "The text says the campaigns change the fabric of our culture but doesn't specify if it's 'positive'." },
                  { id: "q35", type: "choice", text: "35. There is still some uncertainty about whether animals copy the behaviour of the most powerful animals among them.", options: ["YES", "NO", "NOT GIVEN"], correct: "YES", sourceId: "s112", explanation: "The text says 'not all researchers are convinced by the findings' regarding animals imitating dominant (powerful) members." },
                  { id: "q36", type: "choice", text: "36. Consumers make a logical connection between celebrities' achievements and the products they promote.", options: ["YES", "NO", "NOT GIVEN"], correct: "NO", sourceId: "s119", explanation: "Rationally, we know success did not depend on these products; it's instinctual imitation, not a logical connection." }
                ]
              },
              {
                instruction: "Questions 37-40\nComplete each sentence with the correct ending, A - G, below\nWrite the correct letter, A - G , in boxes 37-40 on your answer sheet.",
                questions: [
                  { 
                    id: "q37", type: "choice", text: "37. The behaviour of the monkeys on the island of Koshima showed that", 
                    options: [
                      "A. people imitated behaviour that was linked with success.", 
                      "B. younger animals of a certain species are more likely to imitate each other.", 
                      "C. an animal would imitate another that had higher status.", 
                      "D. imitation of popular sportspeople has occurred for many decades.", 
                      "E. products are marketed to potential consumers who are unaware that marketing is occurring.", 
                      "F. animals can develop new habits by observation.", 
                      "G. incentives are provided for consumers who behave in a certain way."
                    ], 
                    correct: "F. animals can develop new habits by observation.", 
                    explanation: "Potato washing spread from monkey to monkey by observing the first monkey.", 
                    sourceId: "s103" 
                  },
                  { 
                    id: "q38", type: "choice", text: "38. Primatologist Frans de Waal found that", 
                    options: [
                      "A. people imitated behaviour that was linked with success.", 
                      "B. younger animals of a certain species are more likely to imitate each other.", 
                      "C. an animal would imitate another that had higher status.", 
                      "D. imitation of popular sportspeople has occurred for many decades.", 
                      "E. products are marketed to potential consumers who are unaware that marketing is occurring.", 
                      "F. animals can develop new habits by observation.", 
                      "G. incentives are provided for consumers who behave in a certain way."
                    ], 
                    correct: "C. an animal would imitate another that had higher status.", 
                    explanation: "Chimpanzees imitated the limping of a dominant male (higher status).", 
                    sourceId: "s114" 
                  },
                  { 
                    id: "q39", type: "choice", text: "39. Dick Fosbury is mentioned in order to show that", 
                    options: [
                      "A. people imitated behaviour that was linked with success.", 
                      "B. younger animals of a certain species are more likely to imitate each other.", 
                      "C. an animal would imitate another that had higher status.", 
                      "D. imitation of popular sportspeople has occurred for many decades.", 
                      "E. products are marketed to potential consumers who are unaware that marketing is occurring.", 
                      "F. animals can develop new habits by observation.", 
                      "G. incentives are provided for consumers who behave in a certain way."
                    ], 
                    correct: "A. people imitated behaviour that was linked with success.", 
                    explanation: "Imitators copied Fosbury's revolutionary jumping style because it led to success.", 
                    sourceId: "s117" 
                  },
                  { 
                    id: "q40", type: "choice", text: "40. A feature of some modern marketing campaigns is that", 
                    options: [
                      "A. people imitated behaviour that was linked with success.", 
                      "B. younger animals of a certain species are more likely to imitate each other.", 
                      "C. an animal would imitate another that had higher status.", 
                      "D. imitation of popular sportspeople has occurred for many decades.", 
                      "E. products are marketed to potential consumers who are unaware that marketing is occurring.", 
                      "F. animals can develop new habits by observation.", 
                      "G. incentives are provided for consumers who behave in a certain way."
                    ], 
                    correct: "E. products are marketed to potential consumers who are unaware that marketing is occurring.", 
                    explanation: "Stealth marketing campaigns involve people paid to covertly promote products (unaware consumers).", 
                    sourceId: "s120" 
                  }
                ]
              }
            ]
          }
        ];

        // --- COMPONENTS ---

        const TimerDisplay = memo(({ isActive, onTimeUp }) => {
            const [seconds, setSeconds] = useState(3600);
            
            useEffect(() => {
                let interval = null;
                if (isActive && seconds > 0) {
                    interval = setInterval(() => setSeconds(s => s - 1), 1000);
                } else if (seconds === 0) {
                    onTimeUp();
                }
                return () => clearInterval(interval);
            }, [isActive, seconds]);

            const format = (s) => {
                const m = Math.floor(s / 60);
                const sc = s % 60;
                return `${m.toString().padStart(2, '0')}:${sc.toString().padStart(2, '0')}`;
            };

            return <div className={`font-mono text-3xl font-black tracking-tighter ${seconds < 300 ? 'text-red-500 animate-pulse' : 'text-slate-800'}`}>
                {format(seconds)}
            </div>;
        });

        const FlexibleInput = ({ value, onChange, disabled, isReviewing, isCorrect, forceUppercase }) => {
            const spanRef = useRef(null);
            const [width, setWidth] = useState(60);

            useEffect(() => {
                if (spanRef.current) {
                    setWidth(Math.max(60, spanRef.current.offsetWidth + 20));
                }
            }, [value]);

            const handleChange = (e) => {
                const val = e.target.value;
                onChange(forceUppercase ? val.toUpperCase() : val.toLowerCase());
            };

            return (
                <span className="inline-block relative align-middle mx-1">
                    <span ref={spanRef} className={`absolute invisible whitespace-pre font-black px-2 ${forceUppercase ? 'uppercase' : 'lowercase'}`}>
                        {value || "...."}
                    </span>
                    <input 
                        type="text"
                        value={value || ""}
                        onChange={handleChange}
                        disabled={disabled}
                        style={{ width: `${width}px`, textTransform: forceUppercase ? 'uppercase' : 'lowercase' }}
                        className={`flexible-input text-center border-b-2 bg-slate-50/50 rounded-t-lg outline-none font-black text-blue-600 
                            ${isReviewing ? (isCorrect ? 'border-green-500 text-green-700' : 'border-red-500 text-red-700') : 'border-slate-200 focus:border-blue-500'}
                        `}
                    />
                </span>
            );
        };

        const PassageDisplay = memo(({ title, content, reviewFocusId, isReviewing }) => {
            return (
                <div className="max-w-2xl mx-auto">
                    <h1 className="text-4xl font-black text-slate-900 mb-10 font-serif leading-tight">{title}</h1>
                    <div className="text-lg leading-[1.9] text-slate-600 passage-container text-justify space-y-6"
                        dangerouslySetInnerHTML={{ 
                            __html: content.split('</span>').map(segment => {
                                // Chỉ highlight duy nhất dòng chứa sourceId đang focus
                                if (isReviewing && reviewFocusId && segment.includes(`id="${reviewFocusId}"`)) {
                                    return segment.replace(`id="${reviewFocusId}"`, `id="${reviewFocusId}" class="review-highlight duration-1000"`);
                                }
                                return segment;
                            }).join('</span>')
                        }}
                    />
                </div>
            );
        });

        /**
         * Updated Band Score Calculation based on ielts-fighter.com Academic Reading table
         */
        const calculateBandScore = (correctCount) => {
          if (correctCount >= 39) return 9.0;
          if (correctCount >= 37) return 8.5;
          if (correctCount >= 35) return 8.0;
          if (correctCount >= 33) return 7.5;
          if (correctCount >= 30) return 7.0;
          if (correctCount >= 27) return 6.5;
          if (correctCount >= 23) return 6.0;
          if (correctCount >= 20) return 5.5;
          if (correctCount >= 16) return 5.0;
          if (correctCount >= 13) return 4.5;
          if (correctCount >= 10) return 4.0;
          if (correctCount >= 7)  return 3.5;
          if (correctCount >= 5)  return 3.0;
          if (correctCount >= 3)  return 2.5;
          return 1.0;
        };

        const App = () => {
          const [testStatus, setTestStatus] = useState('idle');
          const [currentIdx, setCurrentIdx] = useState(0);
          const [userAnswers, setUserAnswers] = useState({});
          const [reviewFocusId, setReviewFocusId] = useState(null);

          const startTest = () => { setTestStatus('testing'); setUserAnswers({}); setReviewFocusId(null); };
          const finishTest = () => { setTestStatus('finished'); };

          const checkIndividualAnswer = (uAns, cAns) => {
            const u = (uAns || "").trim().toLowerCase();
            const c = (cAns || "").trim().toLowerCase();
            if (c.includes('/')) return c.split('/').map(a => a.trim()).includes(u);
            // Hỗ trợ so khớp Matching Endings (ví dụ người dùng nhập "F" nhưng đáp án là "F. animals...")
            if (u.length === 1 && c.startsWith(u.toLowerCase() + ".")) return true;
            return u === c;
          };

          const handleHighlight = () => {
            const selection = window.getSelection();
            if (!selection.rangeCount || selection.isCollapsed) return;
            document.execCommand('backColor', false, 'rgba(254, 240, 138, 0.8)');
            selection.removeAllRanges();
          };

          const getCorrectCount = () => {
            let count = 0;
            IELTS_CONTENT_DATABASE.forEach(p => {
              p.groups?.forEach(g => {
                g.questions.forEach(q => {
                  if (q.type === 'paragraph-gap') {
                    Object.keys(q.gaps).forEach(gapId => {
                      if (checkIndividualAnswer(userAnswers[gapId], q.gaps[gapId].correct)) count++;
                    });
                  } else {
                    if (checkIndividualAnswer(userAnswers[q.id], q.correct)) count++;
                  }
                });
              });
            });
            return count;
          };

          const correctCount = getCorrectCount();
          const bandScore = calculateBandScore(correctCount);

          if (testStatus === 'idle') return (
            <div className="min-h-screen bg-slate-50 flex items-center justify-center">
              <div className="max-w-md w-full bg-white rounded-3xl shadow-xl p-12 text-center">
                <h1 className="text-3xl font-black mb-8 uppercase tracking-widest text-slate-800">IELTS Reading</h1>
                <button onClick={startTest} className="w-full bg-blue-600 text-white font-black py-4 rounded-xl uppercase tracking-widest shadow-lg hover:bg-blue-700 transition-all">Start Now</button>
              </div>
            </div>
          );

          if (testStatus === 'finished') return (
            <div className="h-screen bg-slate-50 overflow-y-auto py-10 px-4">
              <div className="max-w-2xl w-full bg-white rounded-[3rem] shadow-2xl overflow-hidden border mx-auto">
                <div className="bg-blue-600 p-16 text-white text-center">
                  <h2 className="text-sm opacity-60 mb-2 uppercase tracking-widest font-black">Final Results</h2>
                  <div className="text-8xl md:text-9xl font-black leading-none drop-shadow-lg">{bandScore.toFixed(1)}</div>
                  <p className="mt-4 opacity-80 uppercase tracking-widest font-bold">Score: {correctCount} / 40</p>
                </div>
                <div className="p-12">
                   <div className="flex justify-around mb-12">
                      <div className="text-center">
                         <p className="text-xs text-slate-400 uppercase font-black mb-1">Correct</p>
                         <p className="text-4xl font-black text-slate-800">{correctCount} <span className="text-sm text-slate-300">/ 40</span></p>
                      </div>
                      <div className="text-center">
                         <p className="text-xs text-slate-400 uppercase font-black mb-1">Percentage</p>
                         <p className="text-4xl font-black text-slate-800">{Math.round((correctCount/40)*100)}%</p>
                      </div>
                   </div>
                   <div className="flex flex-col gap-4">
                      <button onClick={() => setTestStatus('reviewing')} className="w-full bg-slate-800 text-white font-black py-5 rounded-2xl uppercase tracking-widest hover:bg-black transition-all shadow-lg">Check Answers</button>
                      <button onClick={() => setTestStatus('idle')} className="text-slate-400 font-bold hover:text-slate-600 uppercase tracking-widest text-xs">Back to Start</button>
                   </div>
                </div>
              </div>
            </div>
          );

          const currentPassage = IELTS_CONTENT_DATABASE[currentIdx];

          return (
            <div className="h-screen flex flex-col bg-white overflow-hidden">
              <header className="h-20 border-b flex items-center justify-between px-8 shrink-0 z-30 bg-white shadow-sm">
                <div className="flex items-center gap-4">
                  <div className="px-3 py-1 bg-blue-600 text-white rounded font-black text-xs uppercase">Passage {currentIdx + 1}</div>
                  <h2 className="font-bold text-slate-400 text-xs uppercase truncate max-w-xs">{currentPassage.title}</h2>
                </div>
                <div className="flex items-center gap-8">
                  <TimerDisplay isActive={testStatus === 'testing'} onTimeUp={finishTest} />
                  <button onClick={finishTest} className="bg-red-500 text-white px-8 py-2 rounded-xl text-xs font-black uppercase shadow-lg shadow-red-100 transition-all active:scale-95">
                    {testStatus === 'reviewing' ? 'Finish Review' : 'Submit'}
                  </button>
                </div>
              </header>

              <main className="flex-1 flex overflow-hidden">
                <div className="w-1/2 flex flex-col border-r relative group bg-white h-full">
                  <button onClick={handleHighlight} className="absolute top-4 right-4 z-20 bg-yellow-300 px-6 py-2 rounded-full text-[10px] font-black border border-yellow-500 opacity-0 group-hover:opacity-100 transition-all shadow-xl">HIGHLIGHT</button>
                  <div className="flex-1 overflow-y-auto p-12 bg-white scroll-smooth selection:bg-yellow-100 h-full">
                    <PassageDisplay 
                        title={currentPassage.title}
                        content={currentPassage.content}
                        reviewFocusId={reviewFocusId}
                        isReviewing={testStatus === 'reviewing'}
                    />
                  </div>
                </div>

                <div className="w-1/2 flex flex-col bg-slate-50 overflow-y-auto p-12 h-full">
                  <div className="max-w-xl mx-auto space-y-12 pb-24">
                    {currentPassage.groups.map((group, gIdx) => (
                      <div key={gIdx} className="space-y-8">
                        <div className="bg-amber-50 border-l-4 border-amber-400 p-8 rounded-r-2xl italic text-slate-700 text-sm leading-relaxed whitespace-pre-wrap shadow-sm">{group.instruction}</div>
                        {group.questions.map((q) => {
                          const qNum = parseInt(q.id.replace('q', '')) || 0;
                          // force Uppercase cho Q14-17 (P2), Q23-26 (P2), và Q37-40 (P3 matching endings)
                          const forceUppercase = (qNum >= 14 && qNum <= 17) || (qNum >= 23 && qNum <= 26) || (qNum >= 37 && qNum <= 40);

                          if (q.type === 'paragraph-gap') {
                            const lines = q.text.split('\n\n');
                            return (
                              <div key={q.id} className="bg-white p-10 rounded-[2.5rem] shadow-sm border-2 border-slate-100">
                                 <div className="text-slate-800 font-medium text-lg leading-loose">
                                    <div className="text-center font-bold mb-6 text-xl text-slate-900 uppercase tracking-wide">
                                      <strong>{lines[0]}</strong>
                                    </div>
                                    <div className="whitespace-pre-wrap text-justify">
                                      {lines.slice(1).join('\n\n').split(/(\[q\d+\])/).map((part, i) => {
                                        const match = part.match(/\[(q\d+)\]/);
                                        if (match) {
                                          const gapId = match[1];
                                          const isCorrect = checkIndividualAnswer(userAnswers[gapId], q.gaps[gapId].correct);
                                          return (
                                            <span key={i} className="inline-block">
                                                <FlexibleInput value={userAnswers[gapId]} onChange={(val) => setUserAnswers({...userAnswers, [gapId]: val})} disabled={testStatus === 'reviewing'} isReviewing={testStatus === 'reviewing'} isCorrect={isCorrect} forceUppercase={false} />
                                                {testStatus === 'reviewing' && (
                                                    <div className="flex flex-col mt-4 bg-slate-50 p-4 rounded-xl border text-xs shadow-inner">
                                                        <span className="font-black text-blue-600 uppercase mb-1">Answer: {q.gaps[gapId].correct}</span>
                                                        <span className="italic text-slate-500">"{q.gaps[gapId].explanation}"</span>
                                                        <button onClick={() => { setReviewFocusId(q.gaps[gapId].sourceId); document.getElementById(q.gaps[gapId].sourceId)?.scrollIntoView({ behavior: 'smooth', block: 'center' }); }} className="text-blue-500 font-black uppercase text-[10px] mt-2 text-left hover:underline">Locate Answer</button>
                                                    </div>
                                                )}
                                            </span>
                                          )
                                        }
                                        return part;
                                      })}
                                    </div>
                                 </div>
                              </div>
                            );
                          }

                          const isCorrect = checkIndividualAnswer(userAnswers[q.id], q.correct);
                          if (q.type === 'gap') return (
                            <div key={q.id} className={`bg-white p-10 rounded-[2.5rem] shadow-sm border-2 transition-all duration-500 ${testStatus === 'reviewing' && reviewFocusId === q.sourceId ? 'border-blue-500 ring-[12px] ring-blue-50' : 'border-slate-100'} text-lg font-bold leading-relaxed`}>
                                {q.text.split('______').map((part, i, arr) => (
                                    <span key={i}>
                                        {part}
                                        {i < arr.length - 1 && <FlexibleInput value={userAnswers[q.id]} onChange={(val) => setUserAnswers({...userAnswers, [q.id]: val})} disabled={testStatus === 'reviewing'} isReviewing={testStatus === 'reviewing'} isCorrect={isCorrect} forceUppercase={forceUppercase} />}
                                    </span>
                                ))}
                                {testStatus === 'reviewing' && (
                                    <div className="mt-8 pt-8 border-t border-slate-50">
                                        <button onClick={() => { setReviewFocusId(q.sourceId); document.getElementById(q.sourceId)?.scrollIntoView({ behavior: 'smooth', block: 'center' }); }}
                                            className="text-blue-600 font-black text-[10px] uppercase flex items-center gap-2 mb-4 hover:bg-blue-50 px-4 py-2 rounded-xl transition-all">
                                            Locate in Text
                                        </button>
                                        <div className="bg-slate-50 p-6 rounded-2xl border text-sm text-slate-600 shadow-inner">
                                            <p className="font-black text-blue-600 uppercase text-xs mb-2">Correct Answer: {q.correct}</p>
                                            <p className="italic font-medium leading-relaxed">"{q.explanation}"</p>
                                        </div>
                                    </div>
                                )}
                            </div>
                          );

                          return (
                            <div key={q.id} className={`bg-white p-10 rounded-[2.5rem] shadow-sm border-2 transition-all duration-500 ${testStatus === 'reviewing' && reviewFocusId === q.sourceId ? 'border-blue-500 ring-[12px] ring-blue-50' : 'border-slate-100'}`}>
                              <p className="text-slate-800 font-bold text-xl mb-8 leading-snug">{q.text}</p>
                              <div className="space-y-2">
                                {q.options.map((opt, i) => (
                                  <button key={i} disabled={testStatus === 'reviewing'} onClick={() => setUserAnswers({...userAnswers, [q.id]: opt})}
                                    className={`w-full text-left p-5 rounded-2xl border-2 transition-all text-sm font-bold flex items-center gap-4
                                      ${userAnswers[q.id] === opt ? 'border-blue-500 bg-blue-50 text-blue-700 shadow-xl' : 'border-slate-50 hover:border-slate-200 text-slate-500'}
                                      ${testStatus === 'reviewing' && checkIndividualAnswer(opt, q.correct) ? 'border-green-500 bg-green-50 text-green-700 ring-4 ring-green-100' : ''}
                                      ${testStatus === 'reviewing' && userAnswers[q.id] === opt && !checkIndividualAnswer(opt, q.correct) ? 'border-red-500 bg-red-50 text-red-700 opacity-60' : ''}
                                    `}>
                                    <div className={`w-4 h-4 rounded-full border-2 ${userAnswers[q.id] === opt ? 'bg-blue-600 border-blue-600' : 'border-slate-200'}`} /> {opt}
                                  </button>
                                ))}
                              </div>
                              {testStatus === 'reviewing' && (
                                <div className="mt-8 pt-8 border-t border-slate-50">
                                  <button onClick={() => { setReviewFocusId(q.sourceId); document.getElementById(q.sourceId)?.scrollIntoView({ behavior: 'smooth', block: 'center' }); }}
                                    className="text-blue-600 text-[10px] font-black uppercase flex items-center gap-2 mb-4 hover:bg-blue-50 px-4 py-2 rounded-xl transition-all">
                                    Locate in Text
                                  </button>
                                  <div className="bg-slate-50 p-6 rounded-2xl border text-sm text-slate-600 shadow-inner">
                                    <p className="font-black text-blue-600 uppercase text-xs mb-2">Correct Answer: {q.correct}</p>
                                    <p className="italic font-medium leading-relaxed">"{q.explanation}"</p>
                                  </div>
                                </div>
                              )}
                            </div>
                          );
                        })}
                      </div>
                    ))}
                  </div>
                </div>
              </main>

              <footer className="h-20 border-t flex items-center justify-between px-12 bg-white shrink-0 shadow-2xl z-40">
                <button disabled={currentIdx === 0} onClick={() => {setCurrentIdx(prev => prev - 1); setReviewFocusId(null);}} className="text-slate-400 font-black text-xs uppercase disabled:opacity-10 hover:text-blue-600 flex items-center gap-2 tracking-widest transition-all">Previous</button>
                <div className="flex gap-4">
                    {[0, 1, 2].map(idx => (
                        <button key={idx} onClick={() => {setCurrentIdx(idx); setReviewFocusId(null);}} className={`w-10 h-10 rounded-xl font-black text-xs transition-all ${currentIdx === idx ? 'bg-blue-600 text-white shadow-lg scale-110' : 'bg-slate-50 text-slate-300 hover:bg-slate-100 hover:text-slate-500'}`}>{idx + 1}</button>
                    ))}
                </div>
                <button disabled={currentIdx === 2} onClick={() => {setCurrentIdx(prev => prev + 1); setReviewFocusId(null);}} className="text-slate-400 font-black text-xs uppercase disabled:opacity-10 hover:text-blue-600 flex items-center gap-2 tracking-widest transition-all">Next</button>
              </footer>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
